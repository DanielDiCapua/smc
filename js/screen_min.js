var apagado=0,encendido=1,estado=1,interval_var=0,isScreenMode=!0,isScreenMode_old,ScrollLeft_value=0,ScrollTop_value=0,original_size=150,MJ_Node=null,isZoomFrameRequired=!1,isKeyboardShowed=!0,touch_start_x=0,touch_start_y=0,distTP_ini=0,distTP_curr=0,FontSize_ini=0,doubleClick_touch=!1;function CallBacksLauncher(){for(var ifun=0;ifun<arguments.length;ifun++)eval(arguments[ifun])}function RePosictionateMenuAndSubmenus(){for(var e=0;e<MenuList.length;e++){var t=MenuList[e];if("block"==$(t).css("display")){var i=buttonMenu_list[e],n=typeMenu_list[e];PositionateMenu(i,t,n);for(var r=0;r<SubMenuList[e].length;r++){var s=SubMenuList[e][r];if("block"==$(s).css("display")){var o=buttonSubMenu_list[e][r],a=typeSubMeny_list[e][r];PositionateMenu(o,s,a)}}}}}function TouchStartHandler(e){var t;doubleClick_touch?1==e.touches.length&&(ZoomOriginal(),e.cancelable&&e.preventDefault()):(doubleClick_touch=!0,setTimeout(function(){doubleClick_touch=!1},300)),t="visible"==$("#screen").css("visibility")?document.getElementById("screen"):document.getElementById("buffer");var i=document.getElementById("screenLine"),n=e.touches[0].pageX,r=e.touches[0].pageY;if(1==e.touches.length)isPointInsideElementBoundary(n,r,i)?(touch_start_x=n,touch_start_y=r):e.cancelable&&e.preventDefault();else if(e.touches.length>=2){var s=e.touches[1].pageX,o=e.touches[1].pageY;if(isPointInsideElementBoundary(n,r,i)&&isPointInsideElementBoundary(s,o,i)){var a=t.querySelectorAll(".MathJax_SVG"),l=$(a[0]).css("font-size");FontSize_ini=parseFloat(l.slice(0,l.length-2)),distTP_ini=Math.sqrt((s-n)*(s-n)+(o-r)*(o-r)),distTP_curr=0,e.cancelable&&e.preventDefault()}}}function TouchMoveHandler(e){var t,i=document.getElementById("screenLine"),n=e.changedTouches[0].pageX,r=e.changedTouches[0].pageY;if(t="visible"==$("#screen").css("visibility")?document.getElementById("screen"):document.getElementById("buffer"),1==e.changedTouches.length){if(isPointInsideElementBoundary(n,r,i)){var s,o,a=touch_start_x-n,l=touch_start_y-r;0!=a&&math.abs(l)/math.abs(a)<1?(s=a,o=0):(s=0,o=l),t.scrollLeft+=s,t.scrollTop+=o,ScrollLeft_value=t.scrollLeft,ScrollTop_value=t.scrollTop,touch_start_x=n,touch_start_y=r,e.cancelable&&e.preventDefault()}}else if(e.changedTouches.length>=2){e.cancelable&&e.preventDefault();var c=e.changedTouches[1].pageX,u=e.changedTouches[1].pageY;if(isPointInsideElementBoundary(n,r,i)&&isPointInsideElementBoundary(c,u,i)){0!=interval_var&&CloseInterval(),distTP_curr=Math.sqrt((c-n)*(c-n)+(u-r)*(u-r));var d=$("#bodyCalculator").css("font-size"),h=parseFloat(d.slice(0,d.length-2)),g=distTP_curr/distTP_ini,v=Math.round(FontSize_ini/h*g*100);v>500&&(v=500),v<10&&(v=10);var f=v+"%",m=t.querySelectorAll(".MathJax_SVG");$(m[0]).css("font-size",f)}}}function TouchEndHandler(e){if(distTP_curr>0){e.cancelable&&e.preventDefault();var t=$("#bodyCalculator").css("font-size"),i=parseFloat(t.slice(0,t.length-2)),n=distTP_curr/distTP_ini,r=Math.round(FontSize_ini/i*n*100);r>500&&(r=500),r<10&&(r=10);var s=r+"%",o=("visible"==$("#screen").css("visibility")?document.getElementById("screen"):document.getElementById("buffer")).querySelectorAll(".MathJax_SVG");$(o[0]).css("font-size",s),Preview.UpdateCursorPosition();var a=r;MathJax.Hub.Config({SVG:{scale:a}}),distTP_curr=0}}function isPointInsideElementBoundary(e,t,i){var n=!1,r=$(i).width(),s=$(i).height(),o=$(i).css("padding-left"),a=parseFloat(o.slice(0,o.length-2)),l=$(i).css("padding-top"),c=parseFloat(l.slice(0,l.length-2)),u=$(i).offset(),d=u.left+a,h=d+r,g=u.top+c-10;return d<=e&&e<=h&&g<=t&&t<=g+s&&(n=!0),n}function DefineRowsHeight(){var e=$("#bodyCalculator").css("padding-top"),t=2*e.slice(0,e.length-2),i=$(window).innerHeight()-t,n=$("#keyboard").outerHeight(),r=parseInt($("#titleLine_div").css("margin-top"))+parseInt($("#titleLine_div").css("margin-bottom")),s=$("#titleLine_div").outerHeight()+r,o=0,a=parseInt($("#inputVar_div").css("margin-top"))+parseInt($("#inputVar_div").css("margin-bottom"));"inline-block"==$("#inputVar_div").css("display")&&(o=$("#inputVar_div").outerHeight()+a+7);var l=0,c=parseInt($("#inputFun_div").css("margin-top"))+parseInt($("#inputFun_div").css("margin-bottom"));"inline-block"==$("#inputFun_div").css("display")&&(l=$("#inputFun_div").outerHeight()+c+7);var u=i-s-n-o-l-$("#angleLine").outerHeight(),d=u+"px";$("#screenLine").css("height",d);var h=$("#screenLine").css("padding-top"),g=h.slice(0,h.length-2),v=$("#screenLine").css("padding-bottom");d=(u=u-g-v.slice(0,v.length-2))+"px",$("#screen").css("line-height",d),$("#buffer").css("line-height",d),"visible"==$("#screen").css("visibility")?selector="#screen":selector="#buffer";var f=$(selector).css("line-height"),m=f.slice(0,f.length-2);u!=m&&(d=u-(m-u)+"px",$("#screen").css("line-height",d),$("#buffer").css("line-height",d))}function myInterval(){estado=estado==encendido?apagado:encendido,document.getElementById("mathjax-cursor").style.opacity=estado}function CloseInterval(){estado=0,document.getElementById("mathjax-cursor").style.opacity=estado,clearInterval(interval_var),interval_var=0}function InitialCursor(){var e,t;"visible"==$("#screen").css("visibility")?(e=document.getElementById("screen"),t="#screen"):(e=document.getElementById("buffer"),t="#buffer"),heightCursor=UpdateCursorSize();var i=$(t).css("height");i=parseFloat(i.slice(0,i.length-2));var n=$("#bodyCalculator").css("font-size"),r=parseFloat(n.slice(0,n.length-2))*original_size/100,s=document.getElementById("mathjax-cursor"),o=$(e).offset(),a=o.left+5,l=o.top+.52*i-.5*r-.5*heightCursor;estado=0,s.style.left=a+"px",s.style.top=l+"px"}function UpdateCursorSize(){var e,t=0;if("root"!=currId){var i=GetElementById(expr_xml,currId),n=i.parentNode;e=n.getAttribute("id");for(var r=n.childNodes,s=(t=0,0);s<r.length;s++){var o=r[s].getAttribute("id");if(o){var a="g#"+o;if(!(c=Preview.preview.querySelectorAll(a))[0])continue;var l=c[0].getBoundingClientRect().height;l>t&&(t=l)}}}else i=GetElementById(expr_xml,currId),e="root";var c;a="g#"+currId;if(0!=(c=Preview.preview.querySelectorAll(a)).length||(a="math#"+currId,0!=(c=Preview.preview.querySelectorAll(a)).length)){var u,d=$(c).css("fontSize"),h=parseFloat(d.slice(0,d.length-2));if("root"==currId)var g=$("#bodyCalculator").css("font-size"),v=parseFloat(g.slice(0,g.length-2))*original_size/100;else v=t;u="visible"==$("#screen").css("visibility")?"#screen":"#buffer";var f=$(u).css("height"),m=parseFloat(f.slice(0,f.length-2)),p=v;"root"==e?p<1.5*h&&(p*=1.5):-1==currId.search("mn")&&-1==currId.search("mo")&&!IsVarOrParamMiNode(i)&&"root"!=currId||IsThereOtherNodeTypes(i)||IsMsupOrMrootOrMsqrtSonNode(i)||(p*=1.5),p>m&&(p=.9*m);var b=p+"px";return $(".mathjax-cursor").css("height",b),p}}function IsThereOtherNodeTypes(e){for(var t=!1,i=e.parentNode.childNodes,n=0;n<i.length;n++){var r=i[n].tagName;if(i[n]!=e&&"mn"!=r&&"mo"!=r&&!IsVarOrParamMiNode(i[n])){t=!0;break}}return t}function EditableNodesList(e){var t="g[id^='mn_'],";return t+="g[id^='mo_'],",t+="g[id^='mfenced_'],",t+="g[id^='msup_'],",t+="g[id^='mfrac_'],",t+="g[id^='msqrt_'],",t+="g[id^='mroot_'],",t+="g[id^='mi_']",document.getElementById(e).querySelectorAll(t)}function GetPosition(e,t){if(isScreenMode){document.getElementById(e);CursorPos=1;var i,n=t.pageX,r=t.pageY,s=EditableNodesList(e),o=null,a=1e6;if(0!=s.length)for(var l=0;l<s.length;l++){var c,u,d,h=s[l].getBoundingClientRect().left,g=s[l].getBoundingClientRect().top,v=s[l].getBoundingClientRect().width,f=$(s[l]).css("fontSize"),m=(parseFloat(f.slice(0,f.length-2)),h+v),p=g+s[l].getBoundingClientRect().height,b=s[l].id,_=searchCharacter(b,"_")-1,y=b.substring(0,_),I=h,M=.5*(p+g),S=m,P=.5*(p+g);if("mfenced"==y){var C=GetElementById(expr_xml,b);if(IsFunctionParenthesisNode(C)||IsNumOrDenOfMfrac(C))continue;IsMroot(C.parentNode)?(u=Math.abs(I-n),d=Math.abs(S-n)):(u=Math.sqrt(Math.pow(I-n,2)+Math.pow(M-r,2)),d=Math.sqrt(Math.pow(S-n,2)+Math.pow(P-r,2))),c=Math.min(u,d)}else{if("mi"==y){C=GetElementById(expr_xml,b);if(!IsVarMiNode(C)&&!IsParamMiNode(C))continue}u=Math.sqrt(Math.pow(I-n,2)+Math.pow(M-r,2)),d=Math.sqrt(Math.pow(S-n,2)+Math.pow(P-r,2)),c=Math.min(u,d)}if(c<a&&(a=c,i=l),("mn"==y||"mo"==y||"mi"==y)&&h<=n&&n<=m&&g<=r&&r<=p){o=s[l];break}}if(!o)o=s[i];if(o){currId=o.id;var x=GetElementById(expr_xml,currId);if(IsNonErasebleNode(x)&&x.nextSibling&&(x=x.nextSibling,currId=x.getAttribute("id")),IsGreyColorNode(x))for(;x.nextSibling&&!IsCommaNode(x.nextSibling);)x=x.nextSibling,currId=x.getAttribute("id");if(IsFunctionParenthesisNode(x)){var B=x.parentNode;currId=B.getAttribute("id")}Preview.UpdateCursorPosition(),0!=interval_var&&CloseInterval(),interval_var=setInterval(myInterval,500)}else{var E=expr_xml.documentElement.lastChild;E?(currId=E.id,Preview.UpdateCursorPosition(),0!=interval_var&&CloseInterval(),interval_var=setInterval(myInterval,500)):currId="root"}}}function SearchMin(e){for(var t,i=1e6,n=0;n<e.length;n++)e[n]<i&&(i=e[n],t=n);return t}function Mousewheel(e){e.wheelDelta>0?ZoomIn():ZoomOut()}function ZoomIn(){var e=("visible"==$("#screen").css("visibility")?document.getElementById("screen"):document.getElementById("buffer")).querySelectorAll(".MathJax_SVG"),t=$(e[0]).css("font-size"),i=parseFloat(t.slice(0,t.length-2)),n=$("#bodyCalculator").css("font-size"),r=parseFloat(n.slice(0,n.length-2)),s=Math.round(i/r*100)+10,o=s+"%";$(e[0]).css("font-size",o),Preview.UpdateCursorPosition();var a=s;MathJax.Hub.Config({SVG:{scale:a}})}function ZoomOut(){var e=("visible"==$("#screen").css("visibility")?document.getElementById("screen"):document.getElementById("buffer")).querySelectorAll(".MathJax_SVG"),t=$(e[0]).css("font-size"),i=parseFloat(t.slice(0,t.length-2)),n=$("#bodyCalculator").css("font-size"),r=parseFloat(n.slice(0,n.length-2)),s=10;Math.round(i/r*100)<=10&&(s=1);var o=Math.round(i/r*100)-s;o<25&&(o=25);var a=o+"%";$(e[0]).css("font-size",a),Preview.UpdateCursorPosition();var l=o;MathJax.Hub.Config({SVG:{scale:l}})}function ZoomOriginal(){var e=("visible"==$("#screen").css("visibility")?document.getElementById("screen"):document.getElementById("buffer")).querySelectorAll(".MathJax_SVG"),t=$("#bodyCalculator").css("font-size"),i=(parseFloat(t.slice(0,t.length-2)),original_size+"%");$(e[0]).css("font-size",i),Preview.UpdateCursorPosition();var n=original_size;MathJax.Hub.Config({SVG:{scale:n}})}window.addEventListener("resize",function(){isInputVarActivated?HideAndShowKeyboard():(DefineRowsHeight(),isScreenMode?InputChanges():Preview.Update()),RePosictionateMenuAndSubmenus()}),window.onclick=function(e){var t="#"+e.target.id,i=-1,n=buttonMenu_list.indexOf(t);if(-1==n)for(var r=0;r<MenuList.length;r++)for(var s=0;s<buttonSubMenu_list[r].length;s++){if(buttonSubMenu_list[r][s]==t){n=r,i=s;break}}for(r=0;r<MenuList.length;r++){r!=n&&$(MenuList[r]).css("display","none");for(s=0;s<buttonSubMenu_list[r].length;s++)r==n&&s==i||$(SubMenuList[r][s]).css("display","none")}};